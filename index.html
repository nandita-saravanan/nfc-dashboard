<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pro Line Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Orbitron', sans-serif;
    background-color: #0a0a0a;
    color: #00f0ff;
    margin: 0; padding: 0;
  }
  .container { max-width: 1200px; margin: 2rem auto; padding: 1rem; }
  header { text-align: center; margin-bottom: 2rem; }
  header h1 { font-size: 2.5rem; color: #00f0ff; text-shadow: 0 0 10px #00f0ff; }
  .card { background: #0d0d0d; border: 1px solid #00f0ff; border-radius: 15px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 0 20px #00f0ff33; }
  .card h2 { margin-bottom: 1rem; font-size: 1.5rem; text-shadow: 0 0 5px #00f0ff; }
  .switch-container { display: flex; align-items: center; gap: 1rem; margin-top: 1rem; }
  .switch { position: relative; display: inline-block; width: 60px; height: 34px; }
  .switch input { display: none; }
  .slider { position: absolute; cursor: pointer; background-color: #111; border: 2px solid #00f0ff; border-radius: 34px; top: 0; left: 0; right: 0; bottom: 0; transition: 0.4s; }
  .slider:before { position: absolute; content: ""; height: 26px; width: 26px; left: 4px; bottom: 4px; background-color: #00f0ff; transition: 0.4s; border-radius: 50%; box-shadow: 0 0 10px #00f0ff; }
  input:checked + .slider { background-color: #0a0a0a; }
  input:checked + .slider:before { transform: translateX(26px); }
  #nfcCode { margin-top: 1rem; font-size: 1.2rem; color: #00f0ff; text-shadow: 0 0 5px #00f0ff; }
  table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
  table th, table td { border: 1px solid #00f0ff; padding: 10px; text-align: center; }
  table th { background: #000a1a; text-shadow: 0 0 5px #00f0ff; }
  tbody tr:nth-child(even) { background-color: #0b0b0b; }
</style>
</head>
<body>

<div class="container">
  <header>
    <h1>Pro Line Dashboard</h1>
  </header>

  <div class="card">
    <h2>NFC Reader</h2>
    <div class="switch-container">
      <label class="switch">
        <input type="checkbox" id="nfcSwitch">
        <span class="slider"></span>
      </label>
      <span>Activate NFC Reader</span>
    </div>
    <div id="nfcCode">NFC Code will appear here...</div>
  </div>

  <div class="card">
    <h2>Product Details</h2>
    <table>
      <thead>
        <tr>
          <th>NFC Tag ID</th>
          <th>Product Name</th>
          <th>SKU</th>
          <th>Production Line</th>
          <th>Shift</th>
          <th>Quantity</th>
          <th>QC Status</th>
          <th>Timestamp</th>
        </tr>
      </thead>
      <tbody id="productTableBody">
        <tr>
          <td colspan="8">Scan an NFC tag to see product details.</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<script>
  // Demo product data (replace with real DB/API in production)
  const products = {
    "NFC001": {
      name: "Mixer Grinder",
      sku: "MG123",
      line: "Line 1",
      shift: "Morning",
      quantity: 1,
      qc: "Passed",
      timestamp: "2025-10-15 08:15:30"
    },
    "NFC002": {
      name: "Toaster",
      sku: "TS456",
      line: "Line 2",
      shift: "Evening",
      quantity: 2,
      qc: "Pending",
      timestamp: "2025-10-15 10:45:12"
    }
  };

  const nfcSwitch = document.getElementById('nfcSwitch');
  const nfcCodeDisplay = document.getElementById('nfcCode');
  const productTableBody = document.getElementById('productTableBody');

  async function startNFCScan() {
    if ('NDEFReader' in window) {
      const ndef = new NDEFReader();
      try {
        await ndef.scan();
        nfcCodeDisplay.textContent = "Scanning for NFC...";
        ndef.onreading = event => {
          const decoder = new TextDecoder();
          for (const record of event.message.records) {
            if (record.recordType === "text") {
              const nfcId = decoder.decode(record.data);
              nfcCodeDisplay.textContent = `NFC Code: ${nfcId}`;

              // Fetch product data
              const product = products[nfcId];
              let newRow;
              if (product) {
                newRow = `
                  <tr>
                    <td>${nfcId}</td>
                    <td>${product.name}</td>
                    <td>${product.sku}</td>
                    <td>${product.line}</td>
                    <td>${product.shift}</td>
                    <td>${product.quantity}</td>
                    <td>${product.qc}</td>
                    <td>${product.timestamp}</td>
                  </tr>
                `;
              } else {
                newRow = `<tr><td colspan="8">No product found for NFC tag: ${nfcId}</td></tr>`;
              }

              // Append the new row instead of replacing table
              productTableBody.insertAdjacentHTML('beforeend', newRow);

              // Scroll table to show latest row
              productTableBody.lastElementChild.scrollIntoView({ behavior: "smooth" });
            }
          }
        };
      } catch (error) {
        nfcCodeDisplay.textContent = "NFC scan failed: " + error;
      }
    } else {
      nfcCodeDisplay.textContent = "NFC not supported on this device/browser.";
    }
  }

  nfcSwitch.addEventListener('change', () => {
    if (nfcSwitch.checked) {
      // Clear table before starting (optional)
      productTableBody.innerHTML = `<tr><td colspan="8">Scan an NFC tag to see product details.</td></tr>`;
      startNFCScan();
    } else {
      nfcCodeDisplay.textContent = "NFC Code will appear here...";
      productTableBody.innerHTML = `<tr><td colspan="8">Scan an NFC tag to see product details.</td></tr>`;
    }
  });
</script>

</body>
</html>
